{let createComment=()=>{$(".create-comment-form").each((i,element)=>{$(element).submit(e=>{e.preventDefault(),$.ajax({type:"post",url:"/comment/create",data:$(e.target).serialize(),success:data=>{let{comment}=data.data,card=newDomComment(comment);$(`#post-comments-${comment.post}`).prepend(card),flashMessages({success:data.message}),deleteComment($(".delete-comment-a",card)),likeComment($(".like-comment",card))},error:err=>{console.log(err.responseText),flashMessages({error:"Error..!"})}})})})},newDomComment=function(comment){return $(`<p id="comment-${comment._id}"> \n      <small> \n      <a class="delete-comment-a" href="/comment/destroy/${comment._id}">X</a>\n      </small>\n      <small>${comment.user.name}</small> \n      ${comment.content} \n      <small><a class="like-comment" href="likes/toogle?type=Comment&id=${comment._id}"><span class="comment-like-count">${comment.likes.length}</span> Likes</a></small>\n      </p>`)},deleteComment=deleteLink=>{$(deleteLink).click(function(e){e.preventDefault(),$.ajax({type:"get",url:$(deleteLink).prop("href"),success:function(data){$(`#comment-${data.data.comment_id}`).remove(),flashMessages({success:data.message})},error:function(err){flashMessages({error:"Error..!"}),console.log(err)}})})},likeComment=likeLink=>{$(likeLink).click(function(e){e.preventDefault(),$.ajax({type:"get",url:$(likeLink).prop("href"),success:function(data){$(".comment-like-count",likeLink).each(function(i,obj){data.deleted?obj.innerText=parseInt(obj.innerText)-1:obj.innerText=parseInt(obj.innerText)+1})},error:function(err){flashMessages({error:"Error..!"}),console.log(err)}})})};$(".delete-comment").each(function(i,obj){deleteComment(obj)}),$(".like-comment").each(function(i,obj){likeComment(obj)}),createComment()}